#!/bin/bash

function usage() {
  echo "nobody - show head and tail of file"
  echo
  echo "version 0.1.1"
  echo "[option]"
  echo "  -n lines: show lines head and tail"
  echo "  -h lines: assign head lines"
  echo "  -t lines: assign tail lines"
}

function get_head() {
  if [[ ! -z "$hd" ]];then
    expr $hd + 1 > /dev/null
    if [[ "$?" -lt 1 ]]; then
      text_head="$(cat $1 | head -"$hd")"
    fi
  else
    text_head="$(cat $1 | head -n "$DEFAULT_REMOVE_LINE")"
  fi
}

function get_tail() {
  if [ ! -z "$tl" ]; then
    expr $tl + 1 > /dev/null
    if [[ "$?" -lt 1 ]]; then
      text_tail="$(cat $1 | tail -"$tl")"
    fi
  else
    text_tail="$(cat $1 | tail -n "$DEFAULT_REMOVE_LINE")"
  fi
}

function disp() {
  get_head "$1"
  get_tail "$1"

  echo "$text_head"
  echo
  echo "~~~~~~~~~~~~~~~~"
  echo
  echo "$text_tail"
}

while getopts "h:t:n:" opts
do
  case $opts in
    h )
      hd="$OPTARG"
      ;;
    t )
      tl="$OPTARG"
      ;;
    n )
      hd="$OPTARG"
      tl="$OPTARG"
      ;;
    \?)
      usage
      exit 1
      ;;
  esac
done

shift $((OPTIND - 1))

DEFAULT_REMOVE_LINE=10

# main
if [[ $# -eq 0 ]]; then
  usage
  exit 0
else
  disp "$1"
fi